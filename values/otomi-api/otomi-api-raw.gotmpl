{{- $v := .Environment.Values }}
{{- $gcr := $v.secret.gcr }}

resources:
  - apiVersion: v1
    data:
      .dockerconfigjson: {{ $gcr.data }}
    kind: Secret
    metadata:
      name: {{ $gcr.name }}
    type: kubernetes.io/dockerconfigjson
  - apiVersion: v1
    kind: ServiceAccount
    metadata:
      name: default
      # namespace: shared
    imagePullSecrets:
    - name: {{ $gcr.name }}